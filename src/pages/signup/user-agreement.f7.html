<template>
	<div class="page" data-name="user-agreement" id="user-agreement">
		<div class="artwork"></div>
        <div class="navbar">
			<div class="navbar-inner sliding">
				<div class="header-cont">
					<div class="header">
						<a href="" class="back-btn back">
							<i class="icons material-icons">chevron_left</i>
						</a>
						<h1 class="title">{{localize "user_agree"}}</h1>
						<div class="none"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="page-content" id="user-agreement">
			<div class="text-cont">
				<p class="text">
					Lorem ipsum dolor sit amet, consectetur adipiscing elit. Dictum viverra blandit pretium vitae,
					aliquet ultrices nunc. Suspendisse mollis amet, a vitae. Donec nunc eu at lectus leo semper
					tincidunt. Orci vitae non ornare ligula duis facilisis fermentum vulputate amet. Egestas ultrices
					duis maecenas sed habitant sapien a. Fringilla sit at interdum cum quam. Enim in phasellus in nibh
					aenean. Nec diam nulla libero pretium. Lectus posuere scelerisque nascetur suspendisse justo
					egestas. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Dictum viverra blandit pretium
                    vitae, aliquet ultrices nunc. Suspendisse mollis amet, a...
                </p>
                <p class="text">
					Lorem ipsum dolor sit amet, consectetur adipiscing elit. Dictum viverra blandit pretium vitae,
					aliquet ultrices nunc. Suspendisse mollis amet, a vitae. Donec nunc eu at lectus leo semper
					tincidunt. Orci vitae non ornare ligula duis facilisis fermentum vulputate amet. Egestas ultrices
					duis maecenas sed habitant sapien a. Fringilla sit at interdum cum quam. Enim in phasellus in nibh
					aenean. Nec diam nulla libero pretium. Lectus posuere scelerisque nascetur suspendisse justo
					egestas. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Dictum viverra blandit pretium
                    vitae, aliquet ultrices nunc. Suspendisse mollis amet, a...
				</p>
			</div>
			
			<div class="btns-cont center">
				<!-- <a href="/signup/confirm" class="button round color-blue small">Accept</a> -->
				<a id="agreement-accept-btn" href="/signup/step1" class="button round color-blue small">{{localize "accept"}}</a>
			</div>
			<div class="footer">
				<div class="sqr_bck" id="sqr1"></div>
				<div class="sqr_bck" id="sqr2"></div>
			</div>
		</div>
	</div>
</template>
<script>
	import $$ from "dom7";
	export default {
		on: {
			pageInit: async function (e, page) {
				var self = this;
				var app = self.$app;

				if (await isUserValidAndHasMembership())
				{
					console.log("valid user and membership, going to home [pageInit]");
					$$("#agreement-accept-btn")[0].href = '/memories/home';
				}
				else
				{
					console.log("not a valid user/membership, going to step1 [pageInit]");
					$$("#agreement-accept-btn")[0].href = '/signup/step1';
				}

				async function isUserValidAndHasMembership()
				{
					let isValid = false;
					let hasMembership = false;
					let result = false;

					isValid = await app.methods.userIsValid();
					hasMembership = await app.methods.userHasValidMembership();
					result = isValid && hasMembership;

					return result;
				}
			},
		},
	};
</script>
